name: PR Merged
on:
  [push, workflow_dispatch]
permissions:
  contents: write
jobs:
  call-e2e-tests:
    name: Test
    uses: ./.github/workflows/e2e-tests.yml
    with:
      app_id: ${{ vars.GS_DEV_APP_ID }}
    secrets:
      app_secret: ${{ secrets.GS_DEV_APP_PK }}
  
  # call-bump-version:
  #   name: Version
  #   # Only run if tests pass
  #   # needs: [ call-get-label, call-e2e-tests ]
  #   uses: digi-serve/.github/.github/workflows/bump-version.yml@master
  #   with:
  #     ref: ${{ github.ref }}
  #     type: patch # ${{ needs.call-get-label.outputs.label }}

  # # call-create-release:
  # #   name: Release
  # #   uses: digi-serve/.github/.github/workflows/create-release.yml@master
  # #   needs: [call-bump-version]
  # #   with:
  # #     tag: v${{ needs.call-bump-version.outputs.new_version }}

  # dispatch-web-update:
  #   name: Dispatch Web Service Update
  #   # needs: [ call-bump-version, call-get-label ]
  #   needs: [ prepare, call-bump-version ]
  #   uses: ./.github/workflows/dispatch-web-update.yml
  #   with:
  #     type: ${{ needs.call-get-label.outputs.label }}
  #     version: ${{ needs.call-bump-version.outputs.new_version }}
  #     repo: test_pwa
  #   secrets:
  #     TOKEN: ${{ secrets.GITHUB_TOKEN }}
  #     # TOKEN: ${{ needs.prepare.outputs.token }}
